import{__awaiter as e,__generator as t}from"./_virtual/_tslib.js";import o from"./load-plugins.js";import s from"./mixins/mixins.js";import{getOptionsFromProps as i,path2Array as r,lngLat2Array as n,bounds2Array as a}from"./utils/amap-helpers.js";import{defineProp as p}from"./mixins/props.js";import c from"./mixins/base.js";import h from"./marker.js";import m from"./circle.js";import l from"./polygon.js";import d from"./polyline.js";import u from"./rectangle.js";var f=h.sealedOptions,g=d.sealedOptions,b=l.sealedOptions,k=u.sealedOptions,w=m.sealedOptions,j=s(c).extend({amapMeta:{prepare:function(){return o("AMap.MouseTool")},initComponent:function(o){return e(this,void 0,void 0,(function(){return t(this,(function(e){return[2,new o.MouseTool(this.$map)]}))}))},add:function(){},remove:function(){}},props:{mode:p({type:String,default:"none"}),clearWhenClose:{type:Boolean,default:!0},options:{type:Object}},data:function(){return{drawingMode:void 0}},computed:{$mousetool:function(){return this.$target}},methods:{close:function(e){this.$mousetool.close(e)},draw:function(){var e=this.$mousetool,t=this.mode;if(t!==this.drawingMode){switch(t){case"none":this.close(this.clearWhenClose);break;case"marker":e.marker(i(this,f.props,this.options||{}));break;case"polyline":e.polyline(i(this,g.props,this.options||{}));break;case"polygon":e.polygon(i(this,b.props,this.options||{}));break;case"rectangle":e.rectangle(i(this,k.props,this.options||{}));break;case"circle":e.circle(i(this,w.props,this.options||{}));break;case"rule":e.rule(i(this,b.props,this.options||{}));break;case"measureArea":e.measureArea(i(this,b.props,this.options||{}));break;case"rectZoomIn":e.rectZoomIn(i(this,b.props,this.options||{}));break;case"rectZoomOut":e.rectZoomOut(i(this,b.props,this.options||{}))}this.drawingMode=t}},_onDraw:function(e){if(this.mode!==this.drawingMode)return this.close(!0),void this.draw();var t=e.obj,o=this.drawingMode,s=t;switch(o){case"marker":s=n(t.getPosition());break;case"polyline":case"polygon":s=r(t.getPath());break;case"rectangle":s=a(t.getBounds());break;case"circle":s={center:n(t.getCenter()),radius:t.getRadius()};break;case"rule":s={path:r(t.getPath()),length:t.getLength()};break;case"measureArea":s={path:r(t.getPath()),area:t.getArea()}}this.$emit("draw",o,s),this.$emit("update:mode","none")}},mounted:function(){return e(this,void 0,void 0,(function(){var e,o=this;return t(this,(function(t){switch(t.label){case 0:return[4,(e=this.$context).ready];case 1:return t.sent(),e.destroyed?[2]:(this.$mousetool.on("draw",this._onDraw),this.$watch("mode",(function(e){"none"!==e&&"none"!==o.drawingMode&&o.close(!0),o.draw()}),{immediate:!0}),[2])}}))}))}});export default j;
